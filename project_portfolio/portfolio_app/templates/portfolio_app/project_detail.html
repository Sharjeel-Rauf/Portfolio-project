{% extends 'base.html' %}
{% block content %}
<!-- Error messages -->
<div class="toast-container position-fixed top-0 end-0 p-3">
    {% for message in messages %}
    <div
      class="toast align-items-center {% if message.tags == 'error' %}bg-danger {% else %} bg-success {% endif %} border-0"
      role="alert" aria-live="assertive" aria-atomic="true" style="margin-top: 100px;">
      <div class="d-flex">
        <div class="toast-body" style="color: white;">
          {{ message }}
        </div>
        <button style="color: white; background-color: transparent;" type="button"
          class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
    {% endfor %}
    {% if form.image.errors %}
    <div class="toast align-items-center bg-danger border-0" role="alert" aria-live="assertive" aria-atomic="true"
      style="margin-top: 100px;">
      <div class="d-flex">
        <div class="toast-body" style="color: white;">
          {{ form.image.errors }}
        </div>
        <button style="color: white; background-color: transparent;" type="button"
          class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
    {% endif %}
  </div>

<div id = "project_details">
<div style = "text-align: center; padding: 16vh 0 1vh 0" class="work-page slide delay01">
    <div class="work-page-content">
        <h1>{{ project.title }}</h1>
    </div>
</div>

{% if no_details %}
    <div class="about-me slide delay03">
        <div style = "text-align: center;" class="description">
            <p>No details yet. Please <a href="{% url 'add_project_detail' project.id %}" style = "padding-top: 0px; display: inline-block;">add</a> the details for the project.</p>
        </div>
    </div>
    <div style = "margin: 4vh auto 4vh auto;" class="back-to-projects">
		<a href="{% url 'portfolio_page' %}">Back to all project </a>
	</div>
{% else %}


<!-- ############################################## -->

<div style = "padding: 1vh 0 16vh 0" class="work-page slide delay01">
	<div class="work-page-content">
        {% for detail in project_details %}
		<h1>{{ detail.code_title }}</h1>
		<h3 class=" text">
			{{ detail.description }}
		</h3>
        {% if detail.python_file %}
		<p>
			<strong>File:</strong> <a style = "width: 120px;" href="{{ detail.python_file.url }}">Download</a>
		</p>
        <p>
			<pre><code id="code-3" class="language-python">{{ detail.python_file_content|linebreaksbr }}</code></pre>
            <button class="btn btn-secondary copy-btn" data-target="code-3">Copy Code</button>
		</p>
        {% endif %}
        <button class = "btn btn-primary" hx-get="{% url 'edit_details' detail.id %}"
        hx-target="#project_details">Edit Details</button>

        {% endfor %}
    </div>
    <div class="back-to-projects">
		<a href="{% url 'portfolio_page' %}">Back to all project </a>
	</div>
    
</div>
    
<!-- ############################################## -->








{% endif %}



<!-- Add Prism.js for syntax highlighting -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/prism.min.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
<script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize Prism for syntax highlighting
    Prism.highlightAll();

    // Add click event listener for the copy buttons
    document.querySelectorAll('.copy-btn').forEach(function(button) {
        button.addEventListener('click', function() {
            // Get the target ID from the data-target attribute
            var targetId = button.getAttribute('data-target');
            console.log("Target ID:", targetId); // Debugging: Log the target ID

            // Ensure the target ID is correct
            targetId = targetId.replace('code-', '');

            // Get the code element based on the target ID
            console.log("Searching for element with ID:", `#code-${targetId}`);
            var codeElement = document.querySelector(`#code-${targetId}`);
            console.log("Code Element:", codeElement); // Debugging: Log the code element

            // Check if the code element exists
            if (!codeElement) {
                console.log("Code element not found for target ID:", targetId);
                return;
            }

            // Verify the content of the code element
            console.log("Code Content:", codeElement.textContent);

            // Create a temporary textarea element
            var tempTextarea = document.createElement('textarea');
            tempTextarea.value = codeElement.textContent;
            document.body.appendChild(tempTextarea);

            // Select and copy the content
            tempTextarea.select();
            document.execCommand('copy');

            // Remove the temporary textarea element
            document.body.removeChild(tempTextarea);

            // Provide feedback to the user
            alert('Code copied to clipboard!');
        });
    });
});


</script>
 <!-- Include jQuery (if not already included) -->
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
 <!-- for toast -->
 <script>
   // Show toast when page loads
   document.addEventListener('DOMContentLoaded', function () {
     var toastElList = [].slice.call(document.querySelectorAll('.toast'));
     var toastList = toastElList.map(function (toastEl) {
       return new bootstrap.Toast(toastEl);
     });
     toastList.forEach(function (toast) {
       toast.show();
     });
   });
 </script>


{% endblock %}


